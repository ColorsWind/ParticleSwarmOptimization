# 粒子群优化
实现基本的粒子群算法求解《Cloudde: A heterogeneous differential evolution algorithm and its distributed cloud version》中的函数。

这里使用标准的粒子群算法，但是粒子越界时将重新随机初始化粒子的位置和速度，原论文使用30维函数进行测试，这里仅使用5维。

# 一、函数分析

## 单峰函数 Sphere

<img src="./Sphere/Expression.png" alt="function" style="zoom:50%;" />

<img src="./Sphere/Axes3D.png" alt="function" style="zoom:5%;" />

<img src="./Sphere/Contourf.png" alt="function" style="zoom:5%;" />

## 多峰函数 Schwefel

<img src="./Schwefel/Expression.png" alt="function" style="zoom:50%;" />

<img src="./Schwefel/Axes3D.png" alt="function" style="zoom:5%;" />

<img src="./Schwefel/Contourf.png" alt="function" style="zoom:5%;" />



# 二、问题求解

以五维为例，程序入口在 ```ProblemSolve.kt```

取 c1=c2=2.0, omega=0.5, N=40, Gmax=4000

| 函数         | y                      | x1                        | x2                       | x3                       | x4                      | x5                       |
| ------------ | ---------------------- | ------------------------- | ------------------------ | ------------------------ | ----------------------- | ------------------------ |
| **Sphere**   | 2.657077365785804E-248 | -4.4741913543490496E-125, | 1.2119935595705303E-124, | 4.2454706522148453E-125, | 8.987303729536893E-125, | -2.9327008692281776E-127 |
| **Schwefel** | 6.363783086271724E-5   | 420.96874610593676,       | 420.9687465745434,       | 420.96874539022514,      | 420.968745480696,       | 420.96874636200516       |



# 三、参数调研



以五维 ```Schwefel```函数为例，程序入口在`ParameterInvestigation`

<img src="./ParameterInvestigation.png" alt="function" style="zoom:5%;" />

可以看出，当pc = 0.4, c1=c2=2.5时效果最好，但用此算法求解`Schwefel`函数的最小值仍然不理想。

附原始数据：

| omega | cc   | avg      | worst    | best     |
| ----- | ---- | -------- | -------- | -------- |
| 0.4   | 1    | 688.1289 | 1164.847 | 340.7827 |
| 0.5   | 1    | 578.2248 | 987.069  | 237.2054 |
| 0.6   | 0.5  | 769.045  | 1224.002 | 335.5875 |
| 0.5   | 0.5  | 703.7027 | 1073.964 | 335.5944 |
| 0.8   | 0.5  | 552.5962 | 930.9474 | 118.4417 |
| 0.4   | 0.5  | 738.5152 | 1579.404 | 253.4914 |
| 0.9   | 0.5  | 424.747  | 815.9945 | 118.4391 |
| 0.7   | 0.5  | 708.5249 | 1046.373 | 118.4385 |
| 0.7   | 1    | 509.09   | 750.1231 | 118.8311 |
| 0.6   | 1    | 578.2896 | 1105.787 | 118.4412 |
| 0.5   | 1.5  | 482.0369 | 908.1464 | 118.4384 |
| 0.4   | 1.5  | 594.9537 | 1164.985 | 217.2019 |
| 0.9   | 1    | 153.4327 | 454.3282 | 0.073926 |
| 0.8   | 1    | 417.8811 | 888.3314 | 118.4384 |
| 0.6   | 1.5  | 541.718  | 948.021  | 217.1496 |
| 0.7   | 1.5  | 390.8926 | 809.445  | 6.36E-05 |
| 0.8   | 1.5  | 225.0391 | 631.6848 | 6.36E-05 |
| 0.5   | 2    | 249.3981 | 631.6848 | 6.36E-05 |
| 0.6   | 2    | 192.7962 | 513.3383 | 6.36E-05 |
| 0.9   | 1.5  | 199.019  | 376.8386 | 38.15766 |
| 0.4   | 2    | 328.3897 | 769.893  | 6.36E-05 |
| 0.7   | 2    | 130.2822 | 355.3151 | 6.36E-05 |
| 0.8   | 2    | 120.8932 | 244.1151 | 0.803207 |
| 0.9   | 2    | 290.5578 | 453.4323 | 82.68721 |
| 0.4   | 2.5  | 84.88331 | 296.1068 | 6.36E-05 |
| 0.5   | 2.5  | 98.80222 | 236.8767 | 7.56E-04 |
| 0.6   | 2.5  | 113.0436 | 241.1872 | 0.269272 |
| 0.8   | 2.5  | 340.1727 | 451.9046 | 152.3813 |
| 0.7   | 2.5  | 194.7594 | 373.543  | 15.68411 |
| 0.4   | 3    | 191.7364 | 452.5313 | 10.9232  |
| 0.9   | 2.5  | 344.149  | 542.0592 | 138.1062 |
| 0.5   | 3    | 254.8081 | 434.7998 | 59.43092 |
| 0.6   | 3    | 302.1879 | 433.7985 | 77.39805 |
| 0.7   | 3    | 378.9777 | 502.5516 | 271.2108 |
| 0.8   | 3    | 390.475  | 578.2402 | 183.4265 |
| 0.9   | 3    | 378.2144 | 526.1303 | 220.3717 |
| 0.4   | 3.5  | 333.2138 | 496.1947 | 220.8654 |
| 0.5   | 3.5  | 346.3798 | 536.3725 | 41.61819 |
| 0.6   | 3.5  | 379.0862 | 534.9201 | 170.8585 |
| 0.7   | 3.5  | 375.1032 | 551.2582 | 228.4879 |
| 0.8   | 3.5  | 391.9381 | 590.0728 | 153.5668 |
| 0.9   | 3.5  | 415.6896 | 566.1377 | 257.3953 |

![](ParameterInvestigation.png)



# 四、算法优化

这里通过以下方式进行优化：

1. 粒子群拓扑结构动态演化，粒子初始只能知道3个粒子的gBest，迭代结束时可以知道40%粒子的gBest
2. 粒子pBest随机遗忘，粒子有随着迭代进行线性增加到概率（最大1%）忘记自己的pBest
重复30次，获取结果：

>118.4383984645167,
>6.363783086271724E-5,
>6.363783177221194E-5,
>6.363783131746459E-5,
>6.363783086271724E-5,
>118.43839825226951,
>6.363783086271724E-5,
>6.376837109201006E-5,
>118.43839825226905,
>6.363783086271724E-5,
>6.363783131746459E-5,
>6.363783131746459E-5,
>6.363783086271724E-5,
>118.43839825226928,
>118.43839825226883,
>6.363783086271724E-5,
>6.363783086271724E-5,
>6.363783086271724E-5,
>6.363783131746459E-5,
>6.363783086271724E-5,
>6.363783177221194E-5,
>6.363783086271724E-5,
>118.43839825226883,
>6.36378340459487E-5,
>6.363811280607479E-5,
>6.363783131746459E-5,
>86.01526251283804,
>6.363783131746459E-5,
>6.363783086271724E-5,
>6.363783086271724E-5,
>**Avg 26.55490387**

通过这种优化，算法有更大概率收敛到最优解。